import CustomCallout from "../../../components/CustomCallout/CustomCallout";

TODO: clean this up, have a clear walkthrough in "Create Pipeline" with examples for all cases we expect people to use. Add cURLs to others.

# Data Pipelines

<CustomCallout type="info">
  To see this API in action, visit our [API Playground](https://developer.mixpanel.com/reference/create-warehouse-pipeline).
</CustomCallout>

The Data Pipelines API contains a list of endpoints that are supported by Mixpanel that help you create and manage your data pipelines. Read our [Data Pipelines guide](/docs/other-bits/data-pipelines) for a full overview.


## Create Pipeline
This request creates an export pipeline. The `type` parameter defines the kind of pipeline that is initiated.

### Raw GCS Pipeline
``` sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=gcs-raw \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data from_date=2023-09-20 \
     --data gcs_bucket=YOUR_GCS_BUCKET
```

### Raw Amazon S3 Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=s3-raw \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data s3_region=us-east-1 \
     --data from_date=2023-09-20 \
     --data s3_bucket=YOUR_S3_BUCKET \
     --data s3_role=YOUR_S3_ROLE
```

### Raw Azure Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=azure-raw \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data from_date=2023-09-20 \
     --data storage_account=YOUR_STORAGE_ACCOUNT \
     --data container_name=YOUR_CONTAINER_NAME \
     --data client_id=YOUR_CLIENT_ID\
     --data client_secret=YOUR_CLIENT_SECRET \
     --data tenant_id=YOUR_TENANT_ID
```

### Schematized Bigquery Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=bigquery \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data bq_region=US \
     --data from_date=2023-09-23
```

### Schematized Snowflake Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=snowflake \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data region=us-west-aws \
     --data from_date=2023-09-23 \
     --data snowflake_share_with=YOUR_ACCOUNT_NAME
```

### Schematized AWS Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=aws \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data s3_region=us-east-1 \
     --data from_date=2023-09-23 \
     --data s3_bucket=YOUR_S3_BUCKET \
     --data s3_role=YOUR_S3_ROLE
```

### Schematized Azure Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=azure-blob \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data from_date=2023-09-23 \
     --data storage_account=YOUR_STORAGE_ACCOUNT \
     --data container_name=YOUR_CONTAINER_NAME \
     --data client_id=YOUR_CLIENT_ID \
     --data client_secret=YOUR_CLIENT_SECRET \
     --data tenant_id=YOUR_TENANT_ID
```

### Schematized GCS Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/create \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data type=gcs-schema \
     --data trial=false \
     --data data_source=events \
     --data frequency=daily \
     --data data_format=json \
     --data gcs_region=northamerica-northeast1 \
     --data from_date=2023-09-23 \
     --data gcs_bucket=YOUR_GCS_BUCKET
```


## Edit Pipeline
This request edit the params for an export pipeline.

### Raw GCS Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Checkout,Add to Cart'
```

### Raw Amazon S3 Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Add to Cart,Checkout'
```

### Raw Azure Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Add to Cart,Checkout'
```

### Schematized Bigquery Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Add to Cart,Checkout'
```

### Schematized Snowflake Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Add to Cart,Checkout'
```

### Schematized AWS Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Add to Cart,Checkout'
```

### Schematized Azure Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Add to Cart,Checkout'
```

### Schematized GCS Pipeline
```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/edit \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME \
     --data 'events=Add to Cart,Checkout'
```

## List Pipeline Logs
This endpoint returns the timestamps of all syncs grouped by date.

```sh
curl --request GET \
     --url 'https://data.mixpanel.com/api/2.0/nessie/pipeline/timeline?project_id={PROJECT_ID}' \
     --header 'accept: application/json'
```


## List Pipelines
This API endpoint returns a list of all pipelines in a project.

```sh
curl --request GET \
     --url 'https://data.mixpanel.com/api/2.0/nessie/pipeline/jobs?project_id={PROJECT_ID}' \
     --header 'accept: application/json'
```

## Get Pipelines
Given the name of the pipeline this API returns the status of the
pipeline. It returns the summary and status of all the recent run export
jobs for the pipeline.

```sh
curl --request GET \
     --url 'https://data.mixpanel.com/api/2.0/nessie/pipeline/status?project_id={PROJECT_ID}&name={YOUR_PIPELINE_NAME}' \
     --header 'accept: application/json'
```


**Example Response:** Status with no Summary and a Filter

```curl
curl https://data.mixpanel.com/api/2.0/nessie/pipeline/status \
  -u API_SECRET: \
  -d name="YOUR_PIPELINE_NAME" \
  -d status="running"
```

**Example Response:** Status with no Summary and a Filter

```json
{
  "canceled": [
    {
      "name": "company-july-2016-backfill-hourly-monoschema",
      "state": "canceled",
      "last_finish": "0000-12-31T16:00:00-08:00",
      "run_at": "2016-07-26T00:00:00-07:00",
      "from_date": "2016-07-26T00:00:00-07:00",
      "to_date": "2016-07-26T00:00:00-07:00"
    },
}
```

## Delete Pipeline
For a given pipeline name, this request deletes the pipeline and stops any future jobs to be scheduled for the pipeline. Deleting the pipeline will result in the loss of all its historical data. If you wish to retain the history, it is recommended to pause the pipeline instead.

```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/cancel \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME
```

## Resume Pipeline
For a given pipeline name, this request resumes the pipeline if it's paused---

```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/resume \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME
```

## Pause Pipeline
Pause a currently running pipeline.

```sh
curl --request POST \
     --url https://data.mixpanel.com/api/2.0/nessie/pipeline/pause \
     --header 'accept: application/json' \
     --header 'content-type: application/x-www-form-urlencoded' \
     --data name=YOUR_PIPELINE_NAME
```
